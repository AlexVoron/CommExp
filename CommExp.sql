SELECT P1.date, P1.electricityreading, P1.electricitytariff, P1.coldwaterreading, P1.coldwatertariff, P1.hotwaterreading, P1.hotwatertariff, P1.watersinktariff, P2.date, P2.electricityreading, P2.electricitytariff, P2.coldwaterreading, P2.coldwatertariff, P2.hotwaterreading, P2.hotwatertariff, P2.watersinktariff, P1.electricityreading-P2.electricityreading AS electricityconsumption, electricityconsumption*P1.electricitytariff AS electricitycost, P1.coldwaterreading-P2.coldwaterreading AS coldwaterconsumption, coldwaterconsumption*P1.coldwatertariff AS coldwatercost, P1.hotwaterreading-P2.hotwaterreading AS hotwaterconsumption, hotwaterconsumption*P1.hotwatertariff AS hotwatercost, coldwaterconsumption+hotwaterconsumption AS watersink, watersink*P1.watersinktariff AS watersinkcost, P1.phone AS phone, electricitycost+coldwatercost+hotwatercost+watersinkcost+phone AS total
FROM readings AS P1, readings AS P2
WHERE (((Month(P2.date))=Month(curdate())-1) AND ((Year(P2.date))=Year(curdate())) AND ((Month(P1.date))=Month(curdate())) AND ((Year(P1.date))=Year(curdate()))) OR (((Month(P2.date))=12) AND ((Year(P2.date))=Year(curdate())-1) AND ((Month(P1.date))=Month(curdate())) AND ((Year(P1.date))=Year(curdate())) AND ((Month(curdate()))=1));
